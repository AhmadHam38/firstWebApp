<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>my first web</title>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

</head>
<body>

<h1>welcom all</h1>
<br>
<h2>
    good  job
</h2>
<form id="userForm">
    <label for="firstName">First Name:</label>
    <input type="text" id="firstName" name="firstName">

    <label for="secondName">Last Name:</label>
    <input type="text" id="secondName" name="secondName">
    <label for="email">email:</label>
    <input type="text" id="email" name="email">
    <label for="address">address:</label>
    <input type="text" id="address" name="address">
    <label for="phoneNumber">Phone Number:</label>
    <input type="number" id="phoneNumber" name="phoneNumber">
    <button type="submit">Save</button><!--onclick="savePerson()-->
</form>
<h2>user list </h2>
<table id="usersTable" border="1">
    <thead>
    <tr>
        <th>ID</th>
        <th>First Name</th>
        <th>Second Name</th>
        <th> Email </th>
        <th> Address </th>
        <th> Phone Number </th>
        <th>operations</th>
    </tr>
    </thead>
    <tbody id="usersList"></tbody>
</table>
<script>

    $(document).ready(function () {
        // Fetch data using AJAX
        function addRow(user) {
            $("#usersList").append("<tr><td>" + user.id + "</td>" +
                "<td>" + user.firstName +
                "</td><td>" + user.secondName + "</td>" +
                "<td>"+user.email+"</td>" +"<td>"+user.address+"</td>"+
                "<td>"+user.phoneNumber+"</td>"+
                "<td>"+"<button onclick='findUserById()'>profile</button>"+"</td>"+
                "</tr>");
        }
        $.ajax({
            type: "GET",
            url: "/users/getAll",
            success: function (users) {
                // Iterate through the products and display them in the table
                const usersList = $("#usersList");
                users.forEach(function (users) {
                    usersList.append("<tr>" +
                        "<td>" + users.id + "</td>"
                        +"<td>"+ users.firstName + "</td>"
                        +"<td>"+ users.secondName +"</td>"+
                        "<td>"+ users.email+"</td>"+
                        "<td>"+users.address+"</td>"
                        +"<td>"+ users.phoneNumber+ "</td>"+
                    "<td>"+ "<button>"+"profile"+"</button>" +"</td>"
                        +"</tr>");
                });
            },
            error: function (error) {
                console.error("Error fetching product data: ", error);
            }
        });

        $("#userForm").submit(function (event) {
            event.preventDefault();
            let user = {
                firstName: $("#firstName").val(),
                secondName: $("#secondName").val(),
                email: $("#email").val(),
                address: $("#address").val(),
                phoneNumber: $("#phoneNumber").val()
            };

            $.ajax({
                type: "POST",
                url: "/users/addUser",
                contentType: "application/json",
                data: JSON.stringify(user),
                success: function () {
                    alert("user saved successfully!");
                    addRow(user)

                },
                error: function (error) {
                    console.log("Error saving person: ", error);
                }
            });
        });

    });
</script>
</body>
</html>